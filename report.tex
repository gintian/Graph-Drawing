\documentclass[11pt]{article}
\usepackage[margin=1.25in]{geometry}
\usepackage{graphicx,float}
\usepackage{amsmath,amsthm,amsfonts}
\usepackage{subcaption} % For side-by-side figures
\usepackage{algorithm,algorithmicx,algpseudocode} % For algorithms

% For labelings/struct descriptions
\usepackage{blindtext}
\usepackage{scrextend}
\addtokomafont{labelinglabel}{\sffamily}

\usepackage{listings} % For source code
\usepackage{algorithm,algorithmicx,algpseudocode} % For algorithms

% Commands
\newcommand{\dist}[2]{\text{dist}\left({#1, #2}\right)}

% Theorems and Corollaries
\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]

%opening
\title{Force Directed Drawing}
\author{Vincent La}

\begin{document}
    
\maketitle
\tableofcontents

\section{Introduction}
Force directed algorithms attempt to draw graphs by relating them to some physical analogy. For example, we may view vertices as steel balls and the edges between them as springs. One of the earlier force directed algorithms, Tutte's Barycenter Algorithm, attempts to place a graph's nodes along it's "center of mass."

\section{Tutte's Barycenter Method}
An early force directed drawing method was Tutte's Barycenter Method. In this method, the force on every vertex is given by 

\[ F(v) = \sum_{(u, v) \in E} (p_u - p_v) \]

Hence, we can ...

\[
\begin{aligned}
    \sum_{(u, v) \in E} (x_u - x_v) &= 0 \\
    \sum_{(u, v) \in E} (y_u - y_v) &= 0 \\
\end{aligned}
\]

Which we may rewrite as

\[
\begin{aligned}
    \deg{(v)}x_v - \sum_{u \in N_1(v)} x_u &= \sum_{w \in N_0(v)} x^*_w \\
    \deg{(v)}y_v - \sum_{u \in N_1(v)} y_u &= \sum_{w \in N_0(v)} y^*_w
\end{aligned}
\]

These equations are linear, and the resulting matrix is diagonally dominant (see Example 1.1). This is because the diagonal consists of vertex degrees, while the other entries $a_{ij}$ are either -1's (if $x_i$ and $x_j$ are neighbors) or 0's if they aren't.

\subsection{Example: Hypercube}
A simple example for which Tutte's method gives aesthetically pleasing results is the hypercube.

\begin{figure}[H]
    \includegraphics[width=\linewidth]{"report/prism_4".pdf}
\end{figure}

In the image below, the hypercube is placed in 500 x 500 pixel grid. The grid is governed by a simple Cartesian coordinate system, where the top left and bottom right corners have coordinates $(-250, 0)$ and $(250, 250)$ respectively. Four vertices are fixed and laid out into a circle of radius 250 centered at the origin. Hence, the bulk of the work performed algorithm is done in placing the center four free vertices. Labeling the free vertices as $x_1, x_2, x_3, x_4$, we may represent the task of laying out the free vertices with this matrix

\[
\begin{bmatrix}
    3 & -1 & 0 & -1 \\
    -1 & 3 & -1 & 0 \\
    0 & -1 & 3 & -1 \\
    -1 & 0 & -1 & 3 \\
\end{bmatrix}
\begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ x_4 \end{bmatrix} =
\begin{bmatrix} 0 \\ 250 \\ 0 \\ -250 \end{bmatrix}
\]

The solution to this matrix is given by $x_1 = x_3 = 0, x_2 = \frac{250}{3}, x_4 = -\frac{250}{3}$.

\subsection{Algorithms}
\subsubsection{Newton-Raphson Iteration}
\begin{algorithm}[H]
    \caption{Barycenter Layout}\label{euclid}
    \begin{algorithmic}[1]       
        % Begin Describing Algorithm   
        \Procedure{barycenter}{$t$}
        \State Layout $n$ fixed vertices in a convex polygon
        \State Construct an (size of free vertices) matrix $A$ as follows
        \[
        A_{i, j} = \begin{cases}
        \deg(v) &{\text{if $i = j$}} \\
        -1      &{\text{if adjacent}} \\
        0       &{\text{otherwise}} \\
        \end{cases}
        \]
        \State Solve $Mx = f_x$ to find the x-coordinates
        \State Solve $My = f_y$ to find the y-coordinates
        \EndProcedure
    \end{algorithmic}
\end{algorithm}

\subsubsection{Linear System}
As seen above, the problem of applying the barycenter method can also been modeled with a linear system.

\begin{algorithm}[H]
    \caption{Barycenter Layout}\label{euclid}
    \begin{algorithmic}[1]       
        % Begin Describing Algorithm   
        \Procedure{barycenter}{$t$}
        \State Layout $n$ fixed vertices in a convex polygon
        \State Construct an (size of free vertices) matrix $A$ as follows
        \[
        A_{i, j} = \begin{cases}
            \deg(v) &{\text{if $i = j$}} \\
            -1      &{\text{if adjacent}} \\
            0       &{\text{otherwise}} \\
        \end{cases}
        \]
        \State Construct an (number of free vertices) vector $x$ as follows
        \[
        x_{i} = \sum{...}
        \]
        \State Solve $Mx = f_x$ to find the x-coordinates
        \State Solve $My = f_y$ to find the y-coordinates
        \EndProcedure
    \end{algorithmic}
\end{algorithm}

\subsection{Case Study: Prism Graph}
The prism graph $\Pi_{n}$ is a 3-connected graph constructed by taking the vertices and edges of an $n$-prism. From the perspective of this drawing algorithm, it allows us to investigate the symmetry and resolution properties.

\subsubsection{Symmetry}
Under certain conditions, the barycenter method produces drawings which preserve symmetry.

\begin{theorem}[Eigenvectors of the Prism Graph]
    Consider the linear system governing the coordinates of the free vertices of the prism graph $\Pi_n$. Now, take its corresponding matrix $M$ and starting at $(1, 0)$, place $n$ points equally along the perimeter of the unit circle. If we create vectors $x = (x_1, ..., x_n), y = (y_1, ..., y_n)$, where $x_i$ is the x-coordinate of the $i^{th}$ unit circle point (and similarly for $y$), then $x, y$ are eigenvectors for $M$ with corresponding eigenvalues
    $\lambda_x = \lambda_y = 3 - 2 \cos{\frac{2\pi}{n}}$.
    
    \begin{proof}
        First, let us prove that this is true for $x$. Notice by the distributivity of linear maps that $Mx = (3I + N)x = 3Ix + Nx$, where $N$ is a matrix composed of all of the $-1's$ in $M$ (and is zero everywhere else). Hence, $N\vec{x}$ is of the form
        \[
        \begin{bmatrix}
        0  & -1  & 0   & ... & 0   & -1 \\
        -1 & \ddots   & \ddots  & 0   & ... & 0 \\
        0  & \ddots  & \ddots   & \ddots  & ... & 0 \\
        0  & ... & \ddots   & \ddots  & \ddots   & 0 \\
        0 & 0   & ... & \ddots   & \ddots  & -1 \\
        -1 & 0   & ... & 0   & -1  & 0 \\
        \end{bmatrix}
        \begin{bmatrix}
        \cos{0} \\ 
        \cos{\frac{2 \pi}{n}} \\
        \dots \\
        \cos{\frac{2 \pi(n-2)}{n}} \\
        \cos{\frac{2 \pi(n-1)}{n}}
        \end{bmatrix}
        \]
        
        Clearly, any vector is an eigenvector of the identity map, so we just have to show that $x$ is an eigenvector of $N$. By the above matrix, showing that $Nx = \lambda_0 x$ is equivalent to showing that the following holds for some $\lambda_0 \in \mathbb{R}$.
        
        \[\begin{cases}
        -\cos{\frac{2 \pi}{n}} - \cos{\frac{2\pi(n-1)}{n}} = \lambda_0 \cos{0} &\text{Equation for the first row} \\
        -\cos{\frac{2 \pi (i - 2)}{n}} - \cos{\frac{2 \pi i}{n}} = \lambda_0 \cos{\frac{2\pi(i-1)}{n}}
        &\text{Equation for the $i^{th}$ row} \\
        \end{cases}\]
        
        Now, the first equation implies that 
        \[\begin{aligned}
        \lambda_0
        &= -\left[
        \cos{\frac{2\pi}{n}} + \cos{\frac{2\pi n - 2\pi}{n}}   
        \right] \\
        &= -2\left[
        \cos{ \frac{
                2 \pi + 2\pi n - 2\pi    
            }{ 2n } }
        \cos{ \frac{
                2\pi - 2\pi n + 2\pi
            }{ 2n }
        } \right]
        &\text{Using sum-product identity} \\
        &= -2\left[
        \cos{ \frac{2 \pi n}{2n} } \cos{\frac{ 4\pi - 2\pi n }{2n} }
        \right] \\
        &= -2\left[
        \cos{ \pi } \cos{ \frac{ 2\pi}{n} - \pi }
        \right] \\
        &= 2\left[
        \cos{ \pi - \frac{ 2\pi}{n}} \right]
        &\text{cos is an even function} \\
        &= -2\cos{ - \frac{ 2\pi}{n} }
        = -2\cos{ \frac{ 2\pi}{n} }
        &\text{Supplementary angles}
        \end{aligned}\]
        
        implying that $\lambda_x = 3 - 2\cos{\frac{2\pi}{n}}$ as desired. Now, we just need to show the equation for the $i^{th}$ row holds. Notice that
        
        \[
        \begin{aligned}
        &-\left[\cos{\frac{2 \pi (i - 2)}{n}} + \cos{\frac{2 \pi i}{n}}\right] \\
        &= -2\left[
        \cos{ \frac{2\pi(i - 2) + 2\pi i}{2n} }
        \cos{ \frac{2\pi(i - 2) - 2\pi i}{2n} }
        \right]
        &\text{Sum-product identity} \\
        &= -2\left[
        \cos{ \frac{\pi i - 2\pi + \pi i}{n} }
        \cos{ \frac{\pi i - 2\pi - \pi i}{n} }
        \right] \\
        &= -2\left[
        \cos{ \frac{\pi i - 2\pi + \pi i}{n} }
        \cos{ \frac{2\pi}{n} }
        \right]
        &\cos{ \frac{-2\pi}{n} } = \cos{ \frac{2\pi}{n} } \\
        &= \lambda_0 \cos{ \frac{2\pi(i - 1)}{n} }
        \end{aligned}
        \]
        
        as desired.
        
        \bigskip
        
        Now, let us prove that this is true for $y$. The proof is very similar to the proof for $x$. Here, $N\vec{y}$ is of the form
        \[
        \begin{bmatrix}
        0  & -1  & 0   & ... & 0   & -1 \\
        -1 & \ddots   & \ddots  & 0   & ... & 0 \\
        0  & \ddots  & \ddots   & \ddots  & ... & 0 \\
        0  & ... & \ddots   & \ddots  & \ddots   & 0 \\
        0 & 0   & ... & \ddots   & \ddots  & -1 \\
        -1 & 0   & ... & 0   & -1  & 0 \\
        \end{bmatrix}
        \begin{bmatrix}
        \sin{0} \\ 
        \sin{\frac{2 \pi}{n}} \\
        \dots \\
        \sin{\frac{2 \pi(n-2)}{n}} \\
        \sin{\frac{2 \pi(n-1)}{n}}
        \end{bmatrix}
        \]
        
        Equivalently, we want to show that the following holds for some $\lambda_1 \in \mathbb{R}$.
        
        \[\begin{cases}
        -\sin{\frac{2 \pi}{n}} - \sin{\frac{2\pi(n-1)}{n}} = \lambda_1 \sin{0} &\text{Equation for the first row} \\
        -\sin{0} - \sin{\frac{2\pi\cdot 2}{n}} = \lambda_1 \sin{\frac{2 \pi}{n}} &\text{Equation for the second row} \\
        -\sin{\frac{2 \pi (i - 2)}{n}} - \sin{\frac{2 \pi i}{n}} = \lambda_1 \sin{\frac{2\pi(i-1)}{n}}
        &\text{Equation for the $i^{th}$ row} \\
        \end{cases}\]
        
        Note that here, we'll fix $\lambda_1$ by using the equation for the 2nd row since in the first row, the right hand side is equal to 0. Now, the second equation implies that 
        \[\begin{aligned}
        \lambda_1 \sin{\frac{2\pi}{n}}
        &= -\left( \sin{0} + \sin{\frac{4\pi n}{n}} \right) \\
        &= -\sin{\frac{4\pi}{n}} \\
        &= -2\sin{\frac{2\pi}{n}}\cos{\frac{2\pi}{n}}
        &\text{Double angle identity} \\
        \end{aligned}\]
        
        Simplifying we get $\lambda_1 = -2\cos{\frac{2\pi}{n}}$, implying $\lambda_y = 3I - 2\cos{\frac{2\pi}{n}}$ as desired. Now, we just need to show that the equation for the $i^{th}$ row holds. Notice that
        
        \[
        \begin{aligned}
        &-\left[\sin{\frac{2 \pi (i - 2)}{n}} + \sin{\frac{2 \pi i}{n}}\right] \\
        &= -2\left[
        \sin{ \frac{2\pi(i - 2) + 2\pi i}{2n} }
        \cos{ \frac{2\pi(i - 2) - 2\pi i}{2n} }
        \right]
        &\text{Sum-product identity} \\
        &= -2\left[
        \sin{ \frac{\pi i - 2\pi + \pi i}{n} }
        \cos{ \frac{\pi i - 2\pi - \pi i}{n} }
        \right] \\
        &= -2\left[
        \sin{ \frac{2\pi(i - 1)}{n} }
        \cos{ \frac{2\pi}{n} }
        \right]
        &\cos{ \frac{-2\pi}{n} } = \cos{ \frac{2\pi}{n} } \\
        &= \lambda_1 \sin{ \frac{2\pi(i - 1)}{n} }
        \end{aligned}
        \]
        
        as desired. Hence, we have shown that our vectors $x, y$ of points along the unit circle are eigenvectors for $M$ indeed.
    \end{proof}
\end{theorem}

\begin{corollary}[Reflectional Symmetry]
    The barycenter method gives a reflectionally symmetric drawing of the prism graph.
    
    \begin{proof}
        From the theorem above, because the unit circle is an eigenvector of the linear system for the prism graph, the location of the free vertices is simply a scalar multiple of the unit circle. Hence, the edges are also drawn along the axis of symmetry of the vertices.
    \end{proof}
\end{corollary}

\subsubsection{Resolution}
One the the main drawbacks of this algorithm is potentially poor resolution, i.e. the more edges and vertices we add to our graph, the harder it becomes to distinguish the different features of our graph. This is demonstrated best by the prism graph.

\begin{figure}[H]
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_4".pdf}
    \end{subfigure}
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_5".pdf}
    \end{subfigure}
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_6".pdf}
    \end{subfigure}
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_7".pdf}
    \end{subfigure}
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_8".pdf}
    \end{subfigure}
    \begin{subfigure}{.3\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_9".pdf}
    \end{subfigure}
\caption{$\Pi_4$ through $\Pi_{9}$ as drawn by Tutte's algorithm. Notice that $\Pi_4$ is isomorphic to the hypercube $Q_2$}
\end{figure}

\begin{figure}[H]
    \begin{subfigure}{.5\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_5".pdf}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_10".pdf}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_20".pdf}
    \end{subfigure}
    \begin{subfigure}{.5\textwidth}
        \includegraphics[width=\linewidth]{"report/prism_40".pdf}
    \end{subfigure}
    \caption{$\Pi_5, \Pi_{10}, \Pi_{20}$ and $\Pi_{40}$ as drawn by Tutte's algorithm}
\end{figure}

\begin{theorem}[Poor Resolution of the Prism Graph]
    For every fixed vertex $u$ in the prism graph $\Pi_{n}$, the distance between it and its adjacent free vertex $v$ tends to 0 as $n$ becomes large.

    \begin{proof}
        From the theorem above, we know that
        \[ v = u \cdot \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \]
        
        Hence,
        \[
        \begin{aligned}
        \dist{u}{v} &= \sqrt{
            % x-coord        
            \left(u_x - u_x \cdot \frac{1}{3 -2\cos{\frac{2\pi}{n}}}
            \right)^2 +
            %
            % y-coord
            \left(u_y - u_y \cdot \frac{1}{3 -2\cos{\frac{2\pi}{n}}}
            \right)^2
            } \\
            &= \sqrt{
            % x-coord        
            \left[u_x
                \left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)
            \right]^2 +
            %
            % y-coord
            \left[u_y
                \left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)
            \right]^2 +
            } \\
            &= \sqrt{
            % x-coord        
            u_x^2
            \left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)^2 +
            %
            % y-coord
            u_y^2
            \left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)^2 } \\
        \end{aligned}
        \]
        
        Using the fact that $u$ is a point on the unit circle,
        \[
        \begin{aligned}
            \dist{u}{v} &= \sqrt{
                \left( u_x^2 + u_y^2 \right)
                \left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)^2
            } \\
            &= \sqrt{\left( u_x^2 + u_y^2 \right)} \cdot
               \sqrt{\left(1 - \frac{1}{3 -2\cos{\frac{2\pi}{n}}} \right)^2} \\
            &= 1 - \frac{1}{3 - 2\cos{\frac{2\pi}{n}}} \\
        \end{aligned}
        \]
        
        If we take the limit as $n$ goes to infinity, we get
        \[
        \dist{u}{v} = 1 - \frac{1}{3 - 2\cos{0}} = 1 - \frac{1}{3 - 2} = 0
        \]
    \end{proof}
\end{theorem}

\section{Appendix}
\subsection{Barycenter Method: Petersen Graph}
\begin{figure}[H]
    \includegraphics[width=\linewidth]{"report/petersen".pdf}
\end{figure}

\end{document}
